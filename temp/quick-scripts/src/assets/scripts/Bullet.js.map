{"version":3,"sources":["assets\\scripts\\Bullet.js"],"names":["e","require","t","module","o","exports","n","i","__extends","Object","setPrototypeOf","__proto__","Array","prototype","hasOwnProperty","call","constructor","create","a","__decorate","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","s","defineProperty","value","c","l","cc","_decorator","ccclass","property","Not","TRACK","DIRECTION","p","Component","d","onLoad","img","node","getComponent","Sprite","getZIndex","zIndex","MapClr","mapSize","height","Math","floor","y","tileSize","setBullet","setData","bulletType","checkTagIsDelety","targetPos","tag","position","clone","isActive","getAngle","angle","resources","load","SpriteFrame","spriteFrame","setBullet_2","onHit","newEffects","deleteNode","active","_pool","ReturnPool","update","GScene","isPause","onUpdata","onCollisionEnter","emit","ListenID","Send_Hurt","hurtData","apply","sub","normalize","add","mul","speed","setPosition","getDistance","CCTool","System","InCamera"],"mappings":";;;;;;AAAA,IAAIA,CAAC,GAACC,OAAN;AACA,IAAIC,CAAC,GAACC,MAAN;AACA,IAAIC,CAAC,GAACC,OAAN;AACA;;AAAa,IAAIC,EAAJ;AAAA,IAAMC,CAAC,GAAC,UAAM,SAAKC,SAAX,KAAuBF,EAAC,GAAC,WAASN,CAAT,EAAWE,CAAX,EAAa;AAAC,SAAM,CAACI,EAAC,GAACG,MAAM,CAACC,cAAP,IAAuB;AAACC,IAAAA,SAAS,EAAC;AAAX,eAAyBC,KAAzB,IAAgC,UAASZ,CAAT,EAAWE,CAAX,EAAa;AAACF,IAAAA,CAAC,CAACW,SAAF,GAAYT,CAAZ;AAAc,GAAnF,IAAqF,UAASF,CAAT,EAAWE,CAAX,EAAa;AAAC,SAAI,IAAIE,CAAR,IAAaF,CAAb;AAAeO,MAAAA,MAAM,CAACI,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCb,CAArC,EAAuCE,CAAvC,MAA4CJ,CAAC,CAACI,CAAD,CAAD,GAAKF,CAAC,CAACE,CAAD,CAAlD;AAAf;AAAsE,GAA5K,EAA8KJ,CAA9K,EAAgLE,CAAhL,CAAN;AAAyL,CAAzM,EAA0M,UAASF,CAAT,EAAWE,CAAX,EAAa;AAAC,WAASE,CAAT,GAAY;AAAC,SAAKY,WAAL,GAAiBhB,CAAjB;AAAmB;;AAAAM,EAAAA,EAAC,CAACN,CAAD,EAAGE,CAAH,CAAD,EAAOF,CAAC,CAACa,SAAF,GAAY,SAAOX,CAAP,GAASO,MAAM,CAACQ,MAAP,CAAcf,CAAd,CAAT,IAA2BE,CAAC,CAACS,SAAF,GAAYX,CAAC,CAACW,SAAd,EAAwB,IAAIT,CAAJ,EAAnD,CAAnB;AAA6E,CAA5V,CAAR;AAAA,IAAsWc,CAAC,GAAC,UAAM,SAAKC,UAAX,IAAuB,UAASnB,CAAT,EAAWE,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAAC,MAAIC,CAAJ;AAAA,MAAMW,CAAC,GAACE,SAAS,CAACC,MAAlB;AAAA,MAAyBC,CAAC,GAACJ,CAAC,GAAC,CAAF,GAAIhB,CAAJ,GAAM,SAAOI,CAAP,GAASA,CAAC,GAACG,MAAM,CAACc,wBAAP,CAAgCrB,CAAhC,EAAkCE,CAAlC,CAAX,GAAgDE,CAAjF;AAAmF,MAAG,YAAU,OAAOkB,OAAjB,IAA0B,cAAY,OAAOA,OAAO,CAACC,QAAxD,EAAiEH,CAAC,GAACE,OAAO,CAACC,QAAR,CAAiBzB,CAAjB,EAAmBE,CAAnB,EAAqBE,CAArB,EAAuBE,CAAvB,CAAF,CAAjE,KAAkG,KAAI,IAAIoB,CAAC,GAAC1B,CAAC,CAACqB,MAAF,GAAS,CAAnB,EAAqB,KAAGK,CAAxB,EAA0BA,CAAC,EAA3B;AAA8B,KAACnB,CAAC,GAACP,CAAC,CAAC0B,CAAD,CAAJ,MAAWJ,CAAC,GAAC,CAACJ,CAAC,GAAC,CAAF,GAAIX,CAAC,CAACe,CAAD,CAAL,GAAS,IAAEJ,CAAF,GAAIX,CAAC,CAACL,CAAD,EAAGE,CAAH,EAAKkB,CAAL,CAAL,GAAaf,CAAC,CAACL,CAAD,EAAGE,CAAH,CAAxB,KAAgCkB,CAA7C;AAA9B;AAA8E,SAAO,IAAEJ,CAAF,IAAKI,CAAL,IAAQb,MAAM,CAACkB,cAAP,CAAsBzB,CAAtB,EAAwBE,CAAxB,EAA0BkB,CAA1B,CAAR,EAAqCA,CAA5C;AAA8C,CAAlsB;;AAAmsBb,MAAM,CAACkB,cAAP,CAAsBvB,CAAtB,EAAwB,YAAxB,EAAqC;AAACwB,EAAAA,KAAK,EAAC,CAAC;AAAR,CAArC;AAAiD,IAAIN,CAAJ;AAAA,IAAMI,CAAC,GAAC1B,CAAC,CAAC,WAAD,CAAT;AAAA,IAAuB6B,CAAC,GAAC7B,CAAC,CAAC,QAAD,CAA1B;AAAA,IAAqC8B,CAAC,GAAC9B,CAAC,CAAC,UAAD,CAAxC;AAAA,IAAqDE,CAAC,GAAC6B,EAAE,CAACC,UAA1D;AAAA,IAAqEhC,CAAC,GAACE,CAAC,CAAC+B,OAAzE;AAAiF/B,CAAC,CAACgC,QAAF,EAAW,CAAChC,CAAC,GAACoB,CAAC,GAACA,CAAC,IAAE,EAAR,EAAYpB,CAAC,CAACiC,GAAF,GAAM,CAAlB,IAAqB,KAAhC,EAAsCjC,CAAC,CAACA,CAAC,CAACkC,KAAF,GAAQ,CAAT,CAAD,GAAa,OAAnD,EAA2DlC,CAAC,CAACA,CAAC,CAACmC,SAAF,GAAY,CAAb,CAAD,GAAiB,WAA5E;AAAwF,IAAIC,CAAJ;AAAA,IAAMtC,CAAC,IAAEsC,CAAC,GAACP,EAAE,CAACQ,SAAL,EAAehC,CAAC,CAACiC,CAAD,EAAGF,CAAH,CAAhB,EAAsBE,CAAC,CAAC3B,SAAF,CAAY4B,MAAZ,GAAmB,YAAU;AAAC,OAAKC,GAAL,GAAS,KAAKC,IAAL,CAAUC,YAAV,CAAuBb,EAAE,CAACc,MAA1B,CAAT;AAA2C,CAA/F,EAAgGL,CAAC,CAAC3B,SAAF,CAAYiC,SAAZ,GAAsB,YAAU;AAAC,OAAKH,IAAL,CAAUI,MAAV,GAAiBrB,CAAC,WAAD,CAAUsB,MAAV,CAAiBC,OAAjB,CAAyBC,MAAzB,IAAiCC,IAAI,CAACC,KAAL,CAAW,KAAKT,IAAL,CAAUU,CAAV,GAAY3B,CAAC,WAAD,CAAUsB,MAAV,CAAiBM,QAAjB,CAA0BJ,MAAjD,IAAyDxB,CAAC,WAAD,CAAUsB,MAAV,CAAiBC,OAAjB,CAAyBC,MAAzB,GAAgC,CAA1H,CAAjB;AAA8I,CAA/Q,EAAgRV,CAAC,CAAC3B,SAAF,CAAYE,IAAZ,GAAiB,YAAU,CAAE,CAA7S,EAA8SyB,CAAC,CAAC3B,SAAF,CAAY0C,SAAZ,GAAsB,UAASvD,CAAT,EAAW;AAAC,MAAIE,CAAJ;AAAA,MAAME,CAAC,GAAC,IAAR;AAAa,OAAKoD,OAAL,GAAaxD,CAAb,EAAe,KAAKyD,UAAL,GAAgBnC,CAAC,CAACc,KAAjC,EAAuC,KAAKsB,gBAAL,OAA0B,KAAK3C,IAAL,GAAUf,CAAC,CAACe,IAAZ,EAAiB,KAAK4C,SAAL,GAAe,KAAKH,OAAL,CAAaI,GAAb,CAAiBjB,IAAjB,CAAsBkB,QAAtB,CAA+BC,KAA/B,EAAhC,EAAuE,KAAKC,QAAL,GAAc,CAAC,CAAtF,EAAwF7D,CAAC,GAACwB,CAAC,WAAD,CAAUsC,QAAV,CAAmB,KAAKrB,IAAL,CAAUkB,QAA7B,EAAsC7D,CAAC,CAAC4D,GAAF,CAAMjB,IAAN,CAAWkB,QAAjD,IAA2D,EAArJ,EAAwJ,KAAKlB,IAAL,CAAUsB,KAAV,GAAgB/D,CAAxK,EAA0K6B,EAAE,CAACmC,SAAH,CAAaC,IAAb,CAAkB,uBAAqBnE,CAAC,CAAC0C,GAAzC,EAA6CX,EAAE,CAACqC,WAAhD,EAA4D,UAASpE,CAAT,EAAWE,CAAX,EAAa;AAACE,IAAAA,CAAC,CAACsC,GAAF,CAAM2B,WAAN,GAAkBnE,CAAlB;AAAoB,GAA9F,CAA1K,EAA0Q,KAAK4C,SAAL,EAApS,CAAvC;AAA6V,CAA1rB,EAA2rBN,CAAC,CAAC3B,SAAF,CAAYyD,WAAZ,GAAwB,UAAStE,CAAT,EAAW;AAAC,MAAII,CAAC,GAAC,IAAN;AAAW,OAAKoD,OAAL,GAAaxD,CAAb,EAAe,KAAKyD,UAAL,GAAgBnC,CAAC,CAACe,SAAjC,EAA2C,KAAKtB,IAAL,GAAUf,CAAC,CAACe,IAAvD,EAA4D,KAAKgD,QAAL,GAAc,CAAC,CAA3E,EAA6EhC,EAAE,CAACmC,SAAH,CAAaC,IAAb,CAAkB,uBAAqBnE,CAAC,CAAC0C,GAAzC,EAA6CX,EAAE,CAACqC,WAAhD,EAA4D,UAASpE,CAAT,EAAWE,CAAX,EAAa;AAACE,IAAAA,CAAC,CAACsC,GAAF,CAAM2B,WAAN,GAAkBnE,CAAlB;AAAoB,GAA9F,CAA7E;AAA6K,CAAv5B,EAAw5BsC,CAAC,CAAC3B,SAAF,CAAY0D,KAAZ,GAAkB,YAAU;AAAC,OAAKb,gBAAL,OAA0BhC,CAAC,WAAD,CAAUsB,MAAV,CAAiBwB,UAAjB,CAA4B,KAAK7B,IAAL,CAAUkB,QAAtC,EAA+C,OAA/C,GAAwD,KAAK9C,IAAL,EAAxD,EAAoE,KAAK0D,UAAL,EAA9F;AAAiH,CAAtiC,EAAuiCjC,CAAC,CAAC3B,SAAF,CAAY6C,gBAAZ,GAA6B,YAAU;AAAC,SAAM,EAAE,KAAKF,OAAL,CAAaI,GAAb,IAAkB,KAAKJ,OAAL,CAAaI,GAAb,CAAiBjB,IAAnC,KAA0C,KAAK8B,UAAL,IAAkB,CAA5D,CAAF,CAAN;AAAwE,CAAvpC,EAAwpCjC,CAAC,CAAC3B,SAAF,CAAY4D,UAAZ,GAAuB,YAAU;AAAC,OAAKV,QAAL,GAAc,CAAC,CAAf,EAAiB,KAAKpB,IAAL,CAAU+B,MAAV,GAAiB,CAAC,CAAnC,EAAqC,KAAK/B,IAAL,CAAUgC,KAAV,CAAgBC,UAAhB,CAA2B,KAAKjC,IAAhC,CAArC;AAA2E,CAArwC,EAAswCH,CAAC,CAAC3B,SAAF,CAAYgE,MAAZ,GAAmB,UAAS7E,CAAT,EAAW;AAAC0B,EAAAA,CAAC,WAAD,CAAUoD,MAAV,CAAiBC,OAAjB,IAA0B,KAAKhB,QAAL,IAAe,KAAKN,UAApB,IAAgC,KAAKuB,QAAL,CAAc,KAAKvB,UAAnB,EAA+BzD,CAA/B,CAA1D;AAA4F,CAAj4C,EAAk4CwC,CAAC,CAAC3B,SAAF,CAAYoE,gBAAZ,GAA6B,UAASjF,CAAT,EAAW;AAACA,EAAAA,CAAC,CAAC2C,IAAF,CAAOuC,IAAP,CAAYpD,CAAC,CAACqD,QAAF,CAAWC,SAAvB,EAAiC,KAAK5B,OAAL,CAAa6B,QAA9C,GAAwD3D,CAAC,WAAD,CAAUsB,MAAV,CAAiBwB,UAAjB,CAA4B,KAAK7B,IAAL,CAAUkB,QAAtC,EAA+C,OAA/C,CAAxD,EAAgH,KAAK9C,IAAL,EAAhH,EAA4H,KAAK0D,UAAL,EAA5H;AAA8I,CAAzjD,EAA0jDvD,CAAC,CAAC,CAAClB,CAAD,CAAD,EAAKwC,CAAL,CAA7jD,CAAP;;AAA6kD,SAASA,CAAT,GAAY;AAAC,MAAIxC,CAAJ;AAAA,MAAMM,CAAC,GAAC,SAAOgC,CAAP,IAAUA,CAAC,CAACgD,KAAF,CAAQ,IAAR,EAAalE,SAAb,CAAV,IAAmC,IAA3C;AAAgD,SAAOd,CAAC,CAAC0E,QAAF,IAAY,CAAChF,CAAC,GAAC,EAAH,EAAOsB,CAAC,CAACc,KAAT,IAAgB,UAASpC,CAAT,EAAW;AAACM,IAAAA,CAAC,CAACkD,OAAF,CAAUI,GAAV,IAAetD,CAAC,CAACkD,OAAF,CAAUI,GAAV,CAAcjB,IAA7B,KAAoCrC,CAAC,CAACqD,SAAF,GAAYrD,CAAC,CAACkD,OAAF,CAAUI,GAAV,CAAcjB,IAAd,CAAmBkB,QAAnB,CAA4BC,KAA5B,EAAhD;AAAqF,QAAI5D,CAAC,GAACI,CAAC,CAACqC,IAAF,CAAOkB,QAAb;AAAA,QAAsBzD,CAAC,GAACE,CAAC,CAACqD,SAAF,CAAY4B,GAAZ,CAAgBrF,CAAhB,EAAmBsF,SAAnB,EAAxB;AAAA,QAAuDxF,CAAC,GAACE,CAAC,CAACuF,GAAF,CAAMrF,CAAC,CAACsF,GAAF,CAAMpF,CAAC,CAACkD,OAAF,CAAUmC,KAAV,GAAgB3F,CAAhB,GAAkB,CAAxB,CAAN,CAAzD;AAA2FM,IAAAA,CAAC,CAACqC,IAAF,CAAOiD,WAAP,CAAmB5F,CAAnB,GAAsB0B,CAAC,WAAD,CAAUmE,WAAV,CAAsBvF,CAAC,CAACqD,SAAxB,EAAkCzD,CAAlC,IAAqC,EAArC,IAAyCI,CAAC,CAACiE,KAAF,EAA/D;AAAyE,GAArR,EAAsRvE,CAAC,CAACsB,CAAC,CAACe,SAAH,CAAD,GAAe,UAASrC,CAAT,EAAW;AAAC,QAAGM,CAAC,CAACqC,IAAF,CAAOU,CAAP,IAAU/C,CAAC,CAACkD,OAAF,CAAUmC,KAAV,GAAgB3F,CAA1B,EAA4B,CAAC6B,CAAC,CAACiE,MAAF,CAASC,MAAT,CAAgBC,QAAhB,CAAyB1F,CAAC,CAACqC,IAAF,CAAOkB,QAAhC,CAAhC,EAA0E,OAAOvD,CAAC,CAACmE,UAAF,EAAP;AAAsB,GAAjZ,EAAkZzE,CAA9Z,GAAiaM,CAAxa;AAA0a;;AAAAF,CAAC,WAAD,GAAUJ,CAAV","sourceRoot":"/","sourcesContent":["var e=require;\nvar t=module;\nvar o=exports;\n\"use strict\";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(r=(a<3?i(r):3<a?i(t,o,r):i(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,\"__esModule\",{value:!0});var r,s=e(\"AppCommon\"),c=e(\"CCTool\"),l=e(\"ListenID\"),t=cc._decorator,e=t.ccclass;t.property,(t=r=r||{})[t.Not=0]=\"Not\",t[t.TRACK=1]=\"TRACK\",t[t.DIRECTION=2]=\"DIRECTION\";var p,e=(p=cc.Component,i(d,p),d.prototype.onLoad=function(){this.img=this.node.getComponent(cc.Sprite)},d.prototype.getZIndex=function(){this.node.zIndex=s.default.MapClr.mapSize.height-(Math.floor(this.node.y/s.default.MapClr.tileSize.height)+s.default.MapClr.mapSize.height/2)},d.prototype.call=function(){},d.prototype.setBullet=function(e){var t,o=this;this.setData=e,this.bulletType=r.TRACK,this.checkTagIsDelety()||(this.call=e.call,this.targetPos=this.setData.tag.node.position.clone(),this.isActive=!0,t=s.default.getAngle(this.node.position,e.tag.node.position)+90,this.node.angle=t,cc.resources.load(\"img/gameResources/\"+e.img,cc.SpriteFrame,function(e,t){o.img.spriteFrame=t}),this.getZIndex())},d.prototype.setBullet_2=function(e){var o=this;this.setData=e,this.bulletType=r.DIRECTION,this.call=e.call,this.isActive=!0,cc.resources.load(\"img/gameResources/\"+e.img,cc.SpriteFrame,function(e,t){o.img.spriteFrame=t})},d.prototype.onHit=function(){this.checkTagIsDelety()||(s.default.MapClr.newEffects(this.node.position,\"onHit\"),this.call(),this.deleteNode())},d.prototype.checkTagIsDelety=function(){return!(this.setData.tag&&this.setData.tag.node||(this.deleteNode(),0))},d.prototype.deleteNode=function(){this.isActive=!1,this.node.active=!1,this.node._pool.ReturnPool(this.node)},d.prototype.update=function(e){s.default.GScene.isPause||this.isActive&&this.bulletType&&this.onUpdata[this.bulletType](e)},d.prototype.onCollisionEnter=function(e){e.node.emit(l.ListenID.Send_Hurt,this.setData.hurtData),s.default.MapClr.newEffects(this.node.position,\"onHit\"),this.call(),this.deleteNode()},a([e],d));function d(){var e,n=null!==p&&p.apply(this,arguments)||this;return n.onUpdata=((e={})[r.TRACK]=function(e){n.setData.tag&&n.setData.tag.node&&(n.targetPos=n.setData.tag.node.position.clone());var t=n.node.position,o=n.targetPos.sub(t).normalize(),e=t.add(o.mul(n.setData.speed*e*2));n.node.setPosition(e),s.default.getDistance(n.targetPos,t)<20&&n.onHit()},e[r.DIRECTION]=function(e){if(n.node.y+=n.setData.speed*e,!c.CCTool.System.InCamera(n.node.position))return n.deleteNode()},e),n}o.default=e"]}