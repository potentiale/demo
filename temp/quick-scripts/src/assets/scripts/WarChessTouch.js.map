{"version":3,"sources":["assets\\scripts\\WarChessTouch.js"],"names":["e","require","t","module","o","exports","n","i","__extends","Object","setPrototypeOf","__proto__","Array","prototype","hasOwnProperty","call","constructor","create","a","__decorate","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","s","defineProperty","value","c","l","p","d","u","f","cc","_decorator","ccclass","property","Component","h","onLoad","MapClr","modelManage","myModel","WCManage","onEnable","node","on","Node","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","TOUCH_CANCEL","onDisable","off","isMove","GScene","isPause","roundType","ROUND_TYPE","USER","touchNum","tween","to","scale","start","setPosition","CCTool","System","GetV2","zIndex","checkLattice","position","exitLattice","getMapPos","ower","getZIndex","itemMoveTo","Notifier","send","ListenID","WC_TouchEnd","oldLattice","x","y","inLattice","getNodeTag","uuid","underTag","active","checkTouchData","newPreview","path","parameter","pos","attribute","data","myPreview_1","checkCanMove","getV2Pos","myPreview_1_path","resources","load","SpriteFrame","spriteFrame","opacity","isMax","level","lv","Cfg","Building999","get","id","JSON","parse","apply"],"mappings":"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","sourceRoot":"/","sourcesContent":["var e=require;\nvar t=module;\nvar o=exports;\n\"use strict\";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(r=(a<3?i(r):3<a?i(t,o,r):i(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,\"__esModule\",{value:!0});var r,s,c=e(\"AppCommon\"),l=e(\"CCTool\"),p=e(\"ListenID\"),d=e(\"Notifier\"),u=e(\"Cfg\"),f=e(\"WarChessManage\"),t=cc._decorator,e=t.ccclass,e=(t.property,s=cc.Component,i(h,s),h.prototype.onLoad=function(){r=c.default.MapClr.modelManage.myModel.WCManage},h.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.TOUCH_START,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.TOUCH_MOVE,this),this.node.on(cc.Node.EventType.TOUCH_END,this.TOUCH_END,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.TOUCH_END,this)},h.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.TOUCH_START,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.TOUCH_MOVE,this),this.node.off(cc.Node.EventType.TOUCH_END,this.TOUCH_END,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.TOUCH_END,this)},h.prototype.TOUCH_START=function(){this.isMove=!c.default.GScene.isPause&&r.roundType==f.ROUND_TYPE.USER&&0==r.touchNum,cc.tween(this.node).to(.1,{scale:.9}).start(),this.isMove&&r.touchNum++},h.prototype.TOUCH_MOVE=function(e){this.isMove&&(this.node.setPosition(l.CCTool.System.GetV2(e)),this.node.zIndex=20,this.checkLattice(this.node.position))},h.prototype.TOUCH_END=function(e){cc.tween(this.node).to(.1,{scale:1}).start(),this.isMove&&(this.exitLattice(),e=c.default.MapClr.getMapPos(l.CCTool.System.GetV2(e)),this.ower.getZIndex(),r.itemMoveTo(this.ower,e),r.touchNum=0,d.Notifier.send(p.ListenID.WC_TouchEnd))},h.prototype.checkLattice=function(e){e=c.default.MapClr.getMapPos(e);this.oldLattice?this.oldLattice.x==e.x&&this.oldLattice.y==e.y||(this.exitLattice(),this.inLattice(e)):this.inLattice(e)},h.prototype.inLattice=function(e){this.oldLattice=e;var t=r.getNodeTag(e);t&&t.uuid!=this.ower.uuid?(this.underTag=t,this.underTag.node.active=!1,t=this.checkTouchData(t),this.newPreview({path:t.parameter[1],pos:e})):this.newPreview({path:this.ower.attribute.data.parameter[1],pos:e})},h.prototype.exitLattice=function(){this.underTag&&(this.underTag.node.active=!0),r.myPreview_1&&(r.myPreview_1.node.active=!1),this.oldLattice=null,this.underTag=null},h.prototype.newPreview=function(e){r.checkCanMove(e.pos)||(r.myPreview_1.node.setPosition(c.default.MapClr.getV2Pos(e.pos)),r.myPreview_1_path!=e.path?(cc.resources.load(\"img/model_4/\"+e.path,cc.SpriteFrame,function(e,t){r.myPreview_1.spriteFrame=t,r.myPreview_1.node.active=!0}),r.myPreview_1.node.opacity=100,r.myPreview_1_path=e.path):r.myPreview_1.node.active=!0)},h.prototype.checkTouchData=function(e){var t,o=this.ower.attribute.data;return this.ower.attribute.isMax?o:(\"string\"==typeof(t=(t=o.level==e.attribute.lv?u.Cfg.Building999.get(o.id+1):t)||o).parameter&&(t.parameter=JSON.parse(t.parameter)),t)},a([e],h));function h(){var e=null!==s&&s.apply(this,arguments)||this;return e.isMove=!1,e.oldLattice=null,e}o.default=e"]}