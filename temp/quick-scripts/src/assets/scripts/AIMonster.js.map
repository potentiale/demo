{"version":3,"sources":["assets\\scripts\\AIMonster.js"],"names":["e","require","t","module","o","exports","n","i","__extends","Object","setPrototypeOf","__proto__","Array","prototype","hasOwnProperty","call","constructor","create","a","__decorate","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","s","defineProperty","value","c","l","p","d","u","f","cc","_decorator","ccclass","property","h","initState","log","ower","_AiParameter","AiParameter","moveSpeed","attribute","data","MoveSpeedGhost","AttackRange","AttackRangeGhost","statesList","StateType","Idle","IdleState","Move","MoveState","Treat","g","Escape","_","Die","DieState","Attack","AttackState","Ready","ReadyState","setAIState","schedule","setIdleDialogue","MapClr","myMap","node","on","ListenID","GameState","GScene","_GameState","GAME_STATE","Game","unschedule","CDManage","CCTool","UpCDFun","atk","atkspeed","target","_atkSpeedDown","isRageAtkSpeed","think","atkDialogue","Init","startPos","getMapPos","position","startPosV2","clone","newThink","CountDown","currentState","Check","Set","NaN","x","y","renounceTarget","setPosition","checkLife","searchPath","searchRole","checkSkill","skillManage","list","energyList","cur","all","useSkill","Up","getIsInRoom","myBed","myTerritoryMap","oldAtkTargetID","myAtkTargetID","roleID","roleList","_life","isBeReported","isAi","push","GetRandomNum","isInvisible","isTest","isAtkMe","isRealAtkMe","player","GetArrTarge","_AttackTime","attackTarget","myDoor","_isActive","getDistance","mySkeleton","timeScale","move","onMoveEnd","Clear","checkAttack","type","Element_Type","Role","checkPointAttaTarget","_lifeRatio","setAtkDialogue","sendAttack","arc","isValid","attackRoleById","searchAttackRole","newDialogue","v2","DialogueList","kill","limt","scaleX","setHurt","emit","Monster_Flee","getTreatmentPoint","setTreatment","healEffects","newEffects","setParent","zIndex","active","setLife","HurtData","hp","onDestroy","unscheduleAllCallbacks","onUplv","update","isPause","_time","OnUpdate","currentStateClr","DialogueNum","apply","m","AIStateBase","C","OnEnter","_myTarget","setAnimation","OnExit","v","_manager","path"],"mappings":"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","sourceRoot":"/","sourcesContent":["var e = require;\nvar t = module;\nvar o = exports;\n\"use strict\";\nvar n, i = this && this.__extends || (n = function(e, t) {\n        return (n = Object.setPrototypeOf || { __proto__: [] }\n            instanceof Array && function(e, t) { e.__proto__ = t } || function(e, t) { for (var o in t) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]) })(e, t)\n    }, function(e, t) {\n        function o() { this.constructor = e }\n        n(e, t), e.prototype = null === t ? Object.create(t) : (o.prototype = t.prototype, new o)\n    }),\n    a = this && this.__decorate || function(e, t, o, n) {\n        var i, a = arguments.length,\n            r = a < 3 ? t : null === n ? n = Object.getOwnPropertyDescriptor(t, o) : n;\n        if (\"object\" == typeof Reflect && \"function\" == typeof Reflect.decorate) r = Reflect.decorate(e, t, o, n);\n        else\n            for (var s = e.length - 1; 0 <= s; s--)(i = e[s]) && (r = (a < 3 ? i(r) : 3 < a ? i(t, o, r) : i(t, o)) || r);\n        return 3 < a && r && Object.defineProperty(t, o, r), r\n    };\nObject.defineProperty(o, \"__esModule\", { value: !0 });\nvar r, s = e(\"AppCommon\"),\n    c = e(\"CCTool\"),\n    l = e(\"ListenID\"),\n    p = e(\"ElementBase\"),\n    d = e(\"GameScene\"),\n    u = e(\"AIState\"),\n    f = e(\"FSMBase\"),\n    t = cc._decorator,\n    e = t.ccclass,\n    e = (t.property, r = f.default, i(h, r), h.prototype.initState = function(e) {\n        var t = this;\n        cc.log(\"初始化所有状态\"), this.ower = e, this._AiParameter = new u.AiParameter, this._AiParameter.moveSpeed = this.ower.attribute.data.MoveSpeedGhost, this._AiParameter.AttackRange = this.ower.attribute.data.AttackRangeGhost, this.statesList[u.StateType.Idle] = new u.IdleState(this), this.statesList[u.StateType.Move] = new u.MoveState(this), this.statesList[u.StateType.Treat] = new g(this), this.statesList[u.StateType.Escape] = new _(this), this.statesList[u.StateType.Die] = new u.DieState(this), this.statesList[u.StateType.Attack] = new u.AttackState(this), this.statesList[u.StateType.Ready] = new u.ReadyState(this), this.setAIState(u.StateType.Idle), this.schedule(this.setIdleDialogue, 3.5), this.setIdleDialogue(), s.default.MapClr.myMap.node.on(l.ListenID.GameState, function() { s.default.GScene._GameState == d.GAME_STATE.Game && t.unschedule(t.setIdleDialogue) }, this), this.CDManage = new c.CCTool.CDManage, this.CDManage.UpCDFun = { atk: function() { return 1 / (t.ower.attribute.data.atkspeed - t.ower.attribute.data.atkspeed * (t.target ? t.target._atkSpeedDown : 0) + t.ower.isRageAtkSpeed) }, think: function() { return 1 }, atkDialogue: function() { return 10 } }, this.CDManage.Init(), this.startPos = s.default.MapClr.getMapPos(this.node.position), this.startPosV2 = this.node.position.clone()\n    }, h.prototype.newThink = function() { s.default.GScene._GameState != d.GAME_STATE.CountDown && this.currentState != u.StateType.Escape && this.currentState != u.StateType.Treat && this.CDManage.Check(\"think\") && (this.CDManage.Set(\"think\"), NaN != this.node.x && NaN != this.node.y || (this.renounceTarget(), this.node.setPosition(this.startPosV2.x, this.startPosV2.y)), this.checkLife() || (this.target ? this.searchPath() : this.searchRole()), this.checkSkill()) }, h.prototype.checkSkill = function() {\n        if (this.currentState == u.StateType.Attack)\n            for (var e = this.ower.skillManage.list, t = 0, o = e.length; t < o; t++) {\n                var n = e[t],\n                    i = this.ower.skillManage.energyList[n];\n                if (i && i.cur >= i.all) { this.ower.skillManage.useSkill(n), this.CDManage.Up(\"atk\"); break }\n            }\n    }, h.prototype.getIsInRoom = function(e) { var t = s.default.MapClr.getMapPos(this.node.position); return !!e.myBed.myTerritoryMap[t.x] && !!e.myBed.myTerritoryMap[t.x][t.y] }, h.prototype.searchRole = function(e) {\n        var t = this;\n        if (this.target) return this.searchPath();\n\n        function o(e) { t.ower.oldAtkTargetID = t.ower.myAtkTargetID, t.ower.myAtkTargetID = e.roleID, t.target = e, t.searchPath() }\n        if (e && 0 < (i = s.default.MapClr.roleList[e])._life) return i.isBeReported = !0, void o(i);\n        var n, i, a = [];\n        for (n in s.default.MapClr.roleList)(i = s.default.MapClr.roleList[n]).isAi && 0 < i._life && a.push(i);\n        e = s.default.GetRandomNum(0, 10) / 10 < .4 || 0 == a.length;\n        s.default.data.isInvisible && (e = !1), s.default.data.isTest && s.default.data.isAtkMe && (e = !0), (e = s.default.data.isRealAtkMe ? !0 : e) && 0 < s.default.GScene.player._life ? o(s.default.GScene.player) : o(s.default.GetArrTarge(a)), this._AttackTime = 0\n    }, h.prototype.searchPath = function() { var e;!this.target || this.target._life <= 0 ? this.renounceTarget() : (this.attackTarget = this.target.myDoor && this.target.myDoor._isActive && !this.getIsInRoom(this.target) ? this.target.myDoor : this.target, s.default.getDistance(this.node.position, this.attackTarget.node.position) < this._AiParameter.AttackRange || (this.attackTarget.node.position.clone().y += 5, e = s.default.MapClr.getMapPos(this.attackTarget.node.position), this.ower.mySkeleton.timeScale = this._AiParameter.moveSpeed / 160, this.move(e))) }, h.prototype.onMoveEnd = function() { this.ower.mySkeleton.timeScale = 1, this.setAIState(u.StateType.Idle), this.CDManage.Clear(\"atk\") }, h.prototype.checkAttack = function(e) { return !!this.attackTarget && (this.attackTarget.type == p.Element_Type.Role ? !!this.checkPointAttaTarget(e) && void 0 : 30 < this._AttackTime && .3 < this.attackTarget._lifeRatio ? void this.renounceTarget() : s.default.getDistance(this.node.position, this.attackTarget.node.position) < this._AiParameter.AttackRange ? (this.setAtkDialogue(), this.sendAttack(this.attackTarget.node), this._AttackTime += e, !0) : void 0) }, h.prototype.checkPointAttaTarget = function(e) {\n        var t = s.default.MapClr.getMapPos(this.node.position),\n            o = null === (o = this.target.myBed) || void 0 === o ? void 0 : o.myTerritoryMap;\n        if (o && o[t.x] && o[t.x][t.y]) {\n            t = o[t.x][t.y].arc;\n            if (t && t._isActive && t.node && t.node.isValid && s.default.getDistance(this.node.position, t.node.position) < this._AiParameter.AttackRange) {\n                if (this._AttackTime += e, this.CDManage.Check(\"atk\") || this.currentState != u.StateType.Move) return this.setAtkDialogue(), this.sendAttack(t.node), !0;\n                this.ower.mySkeleton.timeScale = 1, this.setAIState(u.StateType.Idle)\n            }\n        }\n    }, h.prototype.attackRoleById = function(e) { this.renounceTarget(), this.searchRole(e) }, h.prototype.searchAttackRole = function() { for (var e in s.default.MapClr.roleList) { e = s.default.MapClr.roleList[e]; if (!(e._life <= 0) && s.default.getDistance(this.node.position, e.node.position) <= this._AiParameter.AttackRange) return this.CDManage.Check(\"atk\") && s.default.MapClr.newDialogue(this.node, cc.v2(20, 200), s.default.GetArrTarge(this.DialogueList.kill), 3), this.sendAttack(e.node), !0 } }, h.prototype.sendAttack = function(e) { this.CDManage.Check(\"atk\") && (this.CDManage.Set(\"atk\"), this.ower.mySkeleton.timeScale = 1 / this.CDManage.limt.atk, this.ower.mySkeleton.node.scaleX = this.node.x > e.x ? 1 : -1, this.setAIState(u.StateType.Attack), this.ower.setHurt(e)) }, h.prototype.checkLife = function() { if (this.ower._lifeRatio < .3) return this.node.emit(l.ListenID.Monster_Flee), this.getTreatmentPoint(), !0 }, h.prototype.renounceTarget = function() { this.target = null, this.attackTarget = null, this.ower.mySkeleton.timeScale = 1, this.setAIState(u.StateType.Idle) }, h.prototype.getTreatmentPoint = function() {\n        var t = this;\n        this.currentState != u.StateType.Escape && (this.renounceTarget(), this.ower.mySkeleton.timeScale = this._AiParameter.moveSpeed / 160, this.move(this.startPos, u.StateType.Escape), this.schedule(this.setTreatment, 1), s.default.MapClr.newDialogue(this.node, cc.v2(20, 200), s.default.GetArrTarge(this.DialogueList[u.StateType.Escape]), 3), this.healEffects || s.default.MapClr.newEffects(this.node.position, \"heal\", function(e) { e.setParent(t.node), e.setPosition(0, 0), e.zIndex = t.node.zIndex + 1, t.healEffects = e, t.healEffects.active = !1 }))\n    }, h.prototype.setTreatment = function() { s.default.getDistance(this.startPosV2, this.node.position) < 200 && (this.healEffects && this.healEffects.isValid && (this.healEffects.active || s.default.MapClr.newDialogue(this.node, cc.v2(20, 200), s.default.GetArrTarge(this.DialogueList[u.StateType.Treat]), 9), this.healEffects.active = !0), this.ower.setLife(new p.HurtData(.1 * this.ower.attribute.data.hp)), .95 < this.ower._lifeRatio && (this.healEffects && (this.healEffects.active = !1), this.unschedule(this.setTreatment), this.ower.mySkeleton.timeScale = 1, this.setAIState(u.StateType.Idle))) }, h.prototype.onDestroy = function() { this.unscheduleAllCallbacks() }, h.prototype.onUplv = function() {}, h.prototype.update = function(e) { s.default.GScene.isPause || this.ower._isActive && (this._time += e, s.default.GScene._GameState == d.GAME_STATE.Game && (this.CDManage.OnUpdate(e), this.newThink(e), this.CDManage.Up(\"atk\"), this.checkAttack(this._time) || this.searchAttackRole(), this._time = 0), this.currentStateClr.OnUpdate(e)) }, h.prototype.setIdleDialogue = function() {\n        var e = this.DialogueList[u.StateType.Idle][this.DialogueNum];\n        e ? (s.default.MapClr.newDialogue(this.node, cc.v2(20, 200), e, 2.5), this.DialogueNum++) : this.DialogueNum = 0\n    }, h.prototype.setAtkDialogue = function() { this.CDManage.Check(\"atkDialogue\") && (this.CDManage.Set(\"atkDialogue\"), s.default.MapClr.newDialogue(this.node, cc.v2(20, 200), s.default.GetArrTarge(this.DialogueList[u.StateType.Attack]), 3)) }, a([e], h));\n\nfunction h() { var e = null !== r && r.apply(this, arguments) || this; return e.statesList = [], e._AttackTime = 0, e._time = 0, e.DialogueNum = 0, e.DialogueList = {}, e }\no.default = e;\nvar m, y, g = (y = u.AIStateBase, i(C, y), C.prototype.OnEnter = function() { this._myTarget.setAnimation(\"sitting1\", !0) }, C.prototype.OnUpdate = function() {}, C.prototype.OnExit = function() {}, C),\n    _ = (m = u.AIStateBase, i(v, m), v.prototype.OnEnter = function() { this._myTarget.setAnimation(\"move\", !0) }, v.prototype.OnUpdate = function(e) {\n        if (0 == this._manager.path.length) return this._manager.setAIState(u.StateType.Treat);\n        this.move(e)\n    }, v.prototype.OnExit = function() {}, v);\n\nfunction v() { return null !== m && m.apply(this, arguments) || this }\n\nfunction C() { return null !== y && y.apply(this, arguments) || this }"]}