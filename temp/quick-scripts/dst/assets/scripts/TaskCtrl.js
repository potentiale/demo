
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/TaskCtrl.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '0f93cXj2gpBFIZGYSFYh3YR', 'TaskCtrl');
// scripts/TaskCtrl.js

"use strict";

var e = require;
var t = module;
var o = exports;
"use strict";

Object.defineProperty(o, "__esModule", {
  value: !0
}), o.TaskType = void 0;
var n = e("AppCommon"),
    i = e("CCTool"),
    c = e("UserVo"),
    l = e("ListenID"),
    p = e("Notifier"),
    d = e("Cfg"),
    a = o.TaskType || (o.TaskType = {});
a[a.GetBuilding = 1] = "GetBuilding";
r.prototype.initTask = function (e) {
  this.taskCfgList = d.Cfg.Task.filter({
    mode: e
  }), this.taskCfgList.sort(function (e, t) {
    return e.id - t.id;
  }), this.curTaskMode = e, this._taskInfo = {};

  for (var t = 0, o = this.taskCfgList.length; t < o; t++) {
    for (var n = this.taskCfgList[t], i = n.target[n.target.length - 1], a = [], r = 0, s = n.target.length - 1; r < s; r++) {
      a.push(n.target[r]);
    }

    i = {
      taskId: n.id,
      target: a,
      curPro: 0,
      allPro: i
    };
    this._taskInfo[n.id] = i;
  }

  this._curFinishNum = 0, c.UserVo.getTaskInfo()[e] || (e = this.taskCfgList[this._curFinishNum]) && p.Notifier.send(l.ListenID.Task_ShowTarget, e, this._taskInfo[e.id]);
}, r.prototype.updateTask = function (e, t) {
  if (e == a.GetBuilding) for (var o in this._taskInfo) {
    o = this._taskInfo[o];
    -1 != o.target.indexOf(t.buildId) && (o.curPro += 1, p.Notifier.send(l.ListenID.Task_UpdateTarget, o));
  }
}, r.prototype.finishTask = function (e, t) {
  var o = this.taskCfgList[this._curFinishNum];
  e != o.id && console.warn("任务id不对", e, o.id), n["default"].GScene.player && n["default"].GScene.player.setCoin(o.reward);
  e = cc.v2(0, 0);
  t && (t = t.parent.convertToWorldSpaceAR(t.position), e = n["default"].MainView.PopBox.convertToNodeSpaceAR(t)), i.CCTool.UI.showCurrencyTips("Fish coin", o.reward, !0, e), this._curFinishNum++;
  e = this.taskCfgList[this._curFinishNum];
  e ? p.Notifier.send(l.ListenID.Task_ShowTarget, e, this._taskInfo[e.id]) : c.UserVo.setTaskModeFinish(this.curTaskMode);
}, e = r;

function r() {
  this.taskCfgList = [], this._taskInfo = {}, this.curTaskMode = -1, this._curFinishNum = 0, p.Notifier.addListener(l.ListenID.Task_UpdateTask, this.updateTask, this), p.Notifier.addListener(l.ListenID.Task_FinishTask, this.finishTask, this);
}

o["default"] = e;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcVGFza0N0cmwuanMiXSwibmFtZXMiOlsiZSIsInJlcXVpcmUiLCJ0IiwibW9kdWxlIiwibyIsImV4cG9ydHMiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiVGFza1R5cGUiLCJuIiwiaSIsImMiLCJsIiwicCIsImQiLCJhIiwiR2V0QnVpbGRpbmciLCJyIiwicHJvdG90eXBlIiwiaW5pdFRhc2siLCJ0YXNrQ2ZnTGlzdCIsIkNmZyIsIlRhc2siLCJmaWx0ZXIiLCJtb2RlIiwic29ydCIsImlkIiwiY3VyVGFza01vZGUiLCJfdGFza0luZm8iLCJsZW5ndGgiLCJ0YXJnZXQiLCJzIiwicHVzaCIsInRhc2tJZCIsImN1clBybyIsImFsbFBybyIsIl9jdXJGaW5pc2hOdW0iLCJVc2VyVm8iLCJnZXRUYXNrSW5mbyIsIk5vdGlmaWVyIiwic2VuZCIsIkxpc3RlbklEIiwiVGFza19TaG93VGFyZ2V0IiwidXBkYXRlVGFzayIsImluZGV4T2YiLCJidWlsZElkIiwiVGFza19VcGRhdGVUYXJnZXQiLCJmaW5pc2hUYXNrIiwiY29uc29sZSIsIndhcm4iLCJHU2NlbmUiLCJwbGF5ZXIiLCJzZXRDb2luIiwicmV3YXJkIiwiY2MiLCJ2MiIsInBhcmVudCIsImNvbnZlcnRUb1dvcmxkU3BhY2VBUiIsInBvc2l0aW9uIiwiTWFpblZpZXciLCJQb3BCb3giLCJjb252ZXJ0VG9Ob2RlU3BhY2VBUiIsIkNDVG9vbCIsIlVJIiwic2hvd0N1cnJlbmN5VGlwcyIsInNldFRhc2tNb2RlRmluaXNoIiwiYWRkTGlzdGVuZXIiLCJUYXNrX1VwZGF0ZVRhc2siLCJUYXNrX0ZpbmlzaFRhc2siXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBQyxHQUFDQyxPQUFOO0FBQ0EsSUFBSUMsQ0FBQyxHQUFDQyxNQUFOO0FBQ0EsSUFBSUMsQ0FBQyxHQUFDQyxPQUFOO0FBQ0E7O0FBQWFDLE1BQU0sQ0FBQ0MsY0FB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dEQsQ0FBQyxDQUFDNkIsUUFBRixDQUFXMEIsZUFBbEMsRUFBa0QsS0FBS3hCLFVBQXZELEVBQWtFLElBQWxFLENBQS9FLEVBQXVKOUIsQ0FBQyxDQUFDMEIsUUFBRixDQUFXMkIsV0FBWCxDQUF1QnRELENBQUMsQ0FBQzZCLFFBQUYsQ0FBVzJCLGVBQWxDLEVBQWtELEtBQUtyQixVQUF2RCxFQUFrRSxJQUFsRSxDQUF2SjtBQUErTjs7QUFBQTVDLENBQUMsV0FBRCxHQUFVSixDQUFWIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZT1yZXF1aXJlO1xudmFyIHQ9bW9kdWxlO1xudmFyIG89ZXhwb3J0cztcblwidXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLG8uVGFza1R5cGU9dm9pZCAwO3ZhciBuPWUoXCJBcHBDb21tb25cIiksaT1lKFwiQ0NUb29sXCIpLGM9ZShcIlVzZXJWb1wiKSxsPWUoXCJMaXN0ZW5JRFwiKSxwPWUoXCJOb3RpZmllclwiKSxkPWUoXCJDZmdcIiksYT1vLlRhc2tUeXBlfHwoby5UYXNrVHlwZT17fSk7YVthLkdldEJ1aWxkaW5nPTFdPVwiR2V0QnVpbGRpbmdcIjtyLnByb3RvdHlwZS5pbml0VGFzaz1mdW5jdGlvbihlKXt0aGlzLnRhc2tDZmdMaXN0PWQuQ2ZnLlRhc2suZmlsdGVyKHttb2RlOmV9KSx0aGlzLnRhc2tDZmdMaXN0LnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5pZC10LmlkfSksdGhpcy5jdXJUYXNrTW9kZT1lLHRoaXMuX3Rhc2tJbmZvPXt9O2Zvcih2YXIgdD0wLG89dGhpcy50YXNrQ2ZnTGlzdC5sZW5ndGg7dDxvO3QrKyl7Zm9yKHZhciBuPXRoaXMudGFza0NmZ0xpc3RbdF0saT1uLnRhcmdldFtuLnRhcmdldC5sZW5ndGgtMV0sYT1bXSxyPTAscz1uLnRhcmdldC5sZW5ndGgtMTtyPHM7cisrKWEucHVzaChuLnRhcmdldFtyXSk7aT17dGFza0lkOm4uaWQsdGFyZ2V0OmEsY3VyUHJvOjAsYWxsUHJvOml9O3RoaXMuX3Rhc2tJbmZvW24uaWRdPWl9dGhpcy5fY3VyRmluaXNoTnVtPTAsYy5Vc2VyVm8uZ2V0VGFza0luZm8oKVtlXXx8KGU9dGhpcy50YXNrQ2ZnTGlzdFt0aGlzLl9jdXJGaW5pc2hOdW1dKSYmcC5Ob3RpZmllci5zZW5kKGwuTGlzdGVuSUQuVGFza19TaG93VGFyZ2V0LGUsdGhpcy5fdGFza0luZm9bZS5pZF0pfSxyLnByb3RvdHlwZS51cGRhdGVUYXNrPWZ1bmN0aW9uKGUsdCl7aWYoZT09YS5HZXRCdWlsZGluZylmb3IodmFyIG8gaW4gdGhpcy5fdGFza0luZm8pe289dGhpcy5fdGFza0luZm9bb107LTEhPW8udGFyZ2V0LmluZGV4T2YodC5idWlsZElkKSYmKG8uY3VyUHJvKz0xLHAuTm90aWZpZXIuc2VuZChsLkxpc3RlbklELlRhc2tfVXBkYXRlVGFyZ2V0LG8pKX19LHIucHJvdG90eXBlLmZpbmlzaFRhc2s9ZnVuY3Rpb24oZSx0KXt2YXIgbz10aGlzLnRhc2tDZmdMaXN0W3RoaXMuX2N1ckZpbmlzaE51bV07ZSE9by5pZCYmY29uc29sZS53YXJuKFwi5Lu75YqhaWTkuI3lr7lcIixlLG8uaWQpLG4uZGVmYXVsdC5HU2NlbmUucGxheWVyJiZuLmRlZmF1bHQuR1NjZW5lLnBsYXllci5zZXRDb2luKG8ucmV3YXJkKTtlPWNjLnYyKDAsMCk7dCYmKHQ9dC5wYXJlbnQuY29udmVydFRvV29ybGRTcGFjZUFSKHQucG9zaXRpb24pLGU9bi5kZWZhdWx0Lk1haW5WaWV3LlBvcEJveC5jb252ZXJ0VG9Ob2RlU3BhY2VBUih0KSksaS5DQ1Rvb2wuVUkuc2hvd0N1cnJlbmN5VGlwcyhcIkZpc2ggY29pblwiLG8ucmV3YXJkLCEwLGUpLHRoaXMuX2N1ckZpbmlzaE51bSsrO2U9dGhpcy50YXNrQ2ZnTGlzdFt0aGlzLl9jdXJGaW5pc2hOdW1dO2U/cC5Ob3RpZmllci5zZW5kKGwuTGlzdGVuSUQuVGFza19TaG93VGFyZ2V0LGUsdGhpcy5fdGFza0luZm9bZS5pZF0pOmMuVXNlclZvLnNldFRhc2tNb2RlRmluaXNoKHRoaXMuY3VyVGFza01vZGUpfSxlPXI7ZnVuY3Rpb24gcigpe3RoaXMudGFza0NmZ0xpc3Q9W10sdGhpcy5fdGFza0luZm89e30sdGhpcy5jdXJUYXNrTW9kZT0tMSx0aGlzLl9jdXJGaW5pc2hOdW09MCxwLk5vdGlmaWVyLmFkZExpc3RlbmVyKGwuTGlzdGVuSUQuVGFza19VcGRhdGVUYXNrLHRoaXMudXBkYXRlVGFzayx0aGlzKSxwLk5vdGlmaWVyLmFkZExpc3RlbmVyKGwuTGlzdGVuSUQuVGFza19GaW5pc2hUYXNrLHRoaXMuZmluaXNoVGFzayx0aGlzKX1vLmRlZmF1bHQ9ZSJdfQ==